<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IR&amp;NLP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" th:href="@{../../css/styles.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{../../css/styles.css}">
</head>

<body>
<nav class="navbar navbar-light navbar-expand-md" style="background-color:rgb(47,85,151);position:relative;">
    <div class="container-fluid"><a class="navbar-brand" href="../../index.html" style="width:340px;background-image:url(../../img/logo.png);background-size:cover;height:40px;padding:10px 0px;"></a><button class="navbar-toggler" data-toggle="collapse" data-target="#navcol-1"></button>
        <div
                class="collapse navbar-collapse" id="navcol-1" style="/*text-align:right;*/position:absolute;right:20px;">
            <ul class="nav navbar-nav" style="margin:0 0 0 0px;">
                <li class="nav-item" role="presentation" style="margin:0 5px;"><a class="nav-link" href="../../index.html">首页</a></li>
                <li class="nav-item" role="presentation" style="margin:0 5px;"><a class="nav-link active" href="../../IRforCN.html">信息检索实验</a></li>
                <li class="nav-item" role="presentation" style="margin:0 5px;"><a class="nav-link" href="../../NLP.html">NLP实验</a></li>
                <li class="nav-item" role="presentation" style="margin:0 5px;"><a class="nav-link" href="../../explanation.html">文档与支持</a></li>
            </ul>
        </div>
    </div>
</nav>
<nav class="navbar navbar-light navbar-expand-md">
    <div class="container-fluid"><a href="../../IRforCN/informationretrieval/probabilityModel.html" class="navbar-brand brand">EN</a><button data-toggle="collapse" data-target="#navcol-2" class="navbar-toggler"><span class="sr-only">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
        <div
                class="collapse navbar-collapse" id="navcol-2" style="position:absolute;right:20px;">
            <ul class="nav navbar-nav" style="margin:0 0 0 0px;">
                <li role="presentation" class="nav-item align-self-center" style="margin:0 5px;"><a href="../preprocessing.html" class="nav-link" style="color:rgb(0,0,0);">文档预处理</a></li>
                <li role="presentation" class="nav-item" style="margin:0 5px;"><a href="../invertedindex.html" class="nav-link active" style="color:rgb(0,0,0);">倒排索引表</a></li>
                <li class="dropdown align-self-center" style="margin:0 5px;"><a data-toggle="dropdown" aria-expanded="false" href="#" class="dropdown-toggle nav-link dropdown-toggle" style="color:rgb(0,0,0);font-style:normal;font-family:Microsoft Yahei;font-weight:normal;margin:0;height:30px;line-height:5px;border:solid;border-radius:10px;border-color:rgb(0,0,0);border-width:3px;">文档检索</a>
                    <div
                            role="menu" class="dropdown-menu" style="background-color:rgba(199,199,199,0.5);"><a role="presentation" href="boolean.html" class="dropdown-item">布尔模型</a><a role="presentation" href="vectorSpaceModel.html" class="dropdown-item">向量空间模型</a><a role="presentation" href="probabilityModel.html" class="dropdown-item">概率检索模型</a><a role="presentation" href="languageModel.html" class="dropdown-item">语言模型</a></div>
                </li>
                <li role="presentation" class="nav-item" style="margin:0 5px;"><a href="../performance.html" class="nav-link" style="color:rgb(0,0,0);">检索模型性能</a></li>
            </ul>
        </div>
    </div>
</nav>
<div>
    <div class="container">
        <div class="row">
            <div class="col-md-6" style="padding:0 55px 0 30px;">
                <div class="row">
                    <div class="col">
                        <div  class="row">
                            <div class="col">
                                <div class="input-group" style="height: 38px;font-family:Microsoft Yahei;">
                                    <div class="input-group-prepend"><span class="input-group-text" style="font-size:16px;">请输入查询语句</span></div><input id="inputForPM" type="text" class="form-control" />
                                    <div class="input-group-append">
                                        <button id="searchForVSM" class="btn btn-primary" type="button" style="background-color:#4472c4;font-size:16px;">检索</button>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <div id="first" class="row" style="margin:40px 0 0 0;display:block">
                    <div class="col">
                        <div class="row">
                            <ul class="nav nav-tabs col" style="-ms-flex:0 0 500px;flex:0 0 500px;max-width:40px;padding:0;display:inline-block;">
                                <li class="nav-item nav-tabs-vertical"><a role="tab" data-toggle="tab" href="#tab-4" class="nav-link active" style="border-top-left-radius:.25rem;border-top-right-radius:0;border-bottom-left-radius:.25rem;padding:16px 8px;">简<br />介</a></li>
                                <li class="nav-item nav-tabs-vertical"
                                    style="margin:0 -1px 0 0;"><a role="tab" data-toggle="tab" href="#tab-5" class="nav-link" style="border-top-left-radius:.25rem;border-top-right-radius:0;border-bottom-left-radius:.25rem;padding:16px 8px;">流<br />程</a></li>
                                <li class="nav-item nav-tabs-vertical"
                                    style="margin:0 -1px 0 0;"><a role="tab" data-toggle="tab" href="#tab-6" class="nav-link" style="border-top-left-radius:.25rem;border-top-right-radius:0;border-bottom-left-radius:.25rem;padding:16px 8px;">优<br />劣</a></li>
                            </ul>
                            <div class="tab-content col" style="height:470px;">
                                <div role="tabpanel" class="tab-pane active" id="tab-4">
                                    <p>概率检索模型是当前信息检索领域效果最好的模型之一，它基于对已有反馈结果的分析，根据贝叶斯原理为当前查询排序。概率检索模型的基本原理与朴素贝叶斯分类是一样的。
                                    </p>
                                </div>
                                <div role="tabpanel" class="tab-pane" id="tab-5">
                                    <p>
                                        1.求索引项<br>
                                        2.求系数Bij<br>
                                        3.计算相似度<br>
                                        4.按相似度降序排序<br>
                                    </p>
                                </div>
                                <div role="tabpanel" class="tab-pane" id="tab-6">
                                    <p>
                                        <strong>优点</strong><br>
                                        文档可以按照他们相关概率递减的顺序来计算秩（rank）。<br>
                                        <br>
                                        <strong>缺点</strong><br>
                                        开始时需要猜想把文档分为相关和不相关的两个集合，实际上这种模型没有考虑索引术语在文档中的频率（因
                                        为所有的权重都是二元的），而索引术语都是相互独立的。
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="second" class="row" style="display: none">
                    <div class="col">
                        <div class="row" style="margin:0;">
                            <div class="col" style="padding:0;">
                                <h3 class="text-center" style="height:40px;line-height:40px;font-size:20px;padding:0;
                                margin:0;color:rgb(0,0,0);font-family:微软雅黑;font-weight:bold;">检索结果</h3>
                                <div id="searchResults" class="suojin text" style="height:420px;margin:0;"></div>
                                <button id="introduce" class="btn btn-primary" type="button" style="background-color:#4472c4;
                                font-size:16px;float:right;margin:10px 0;">介绍</button>
                                <button id="return" class="btn btn-primary" type="button" style="background-color:#4472c4;
                                font-size:16px;float:right;margin:10px 0;">返回</button>

                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6" style="padding:0 10px 0 55px;">
                <div class="row">
                    <div class="col">
                        <h3 style="/*float:right;*/font-size:20px;padding:0;margin:0;color:rgb(0,0,0);font-family:微软雅黑;font-weight:bold;height:25px;">查看检索流程</h3>
                        <div style="margin-top:30px;">
                            <button id="PPQ" class="btn btn-primary bigButton" type="button">求索引项</button>
                            <img src="../../img/箭头右.png" height="20px" />
                            <button id="calculateBij" class="btn btn-primary bigButton" type="button">求系数Bij</button>
                            <img src="../../img/箭头右.png" height="20px" />
                            <button id="similarities" class="btn btn-primary bigButton" type="button">计算相似度</button>
                            <img src="../../img/箭头右.png" height="20px" />
                            <button id="sortSimilarity" class="btn btn-primary bigButton" type="button">按相似度降序排序</button></div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="row" style="margin:0;">
                            <div class="col" style="-ms-flex:0 0 90%;flex:0 0 90%;max-width:90%;padding:0;">
                                <div style="float:none;margin:auto;">
                                    <h3 class="text-center" style="/*float:right;*/height:40px;line-height:40px;font-size:20px;padding:0;margin:10px;color:rgb(0,0,0);font-family:微软雅黑;font-weight:bold;">中间结果</h3>
                                </div>
                                <div id="results" class="suojin text" style="height:395px;margin:0;"></div>
                            </div>
                            <div class="col" style="-ms-flex:0 0 10%;flex:0 0 10%;max-width:10%;padding:0;"><button class="btn btn-primary" type="button" style="display:block;margin:60px 15px 0;background-color:#4472c4;"><i class="fa fa-undo"></i></button><button class="btn btn-primary" type="button" style="display:block;margin:10px 15px;background-color:#4472c4;"><i class="fa fa-repeat"></i></button></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<footer style="color:rgb(47,85,151);width:100%;height:35px;line-height:35px;background-color:#2f5597;background-position:bottom;margin:0px;padding:0;position:fixed;bottom:0;">
    <p class="text-center" style="font-family:微软雅黑;color:rgb(255,255,255);">©copyright 2018 武汉大学信息检索与知识挖掘研究所 </p>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/js/bootstrap.bundle.min.js"></script>
</body>
<script type="text/javascript">
    var json=null;
    var $searchResults=null;

    $(function () {

        $("#introduce").click(function () {
            $("#first").show();
            $("#second").hide();
        });//显示介绍界面

        $("#return").click(function () {
            $("#searchResults").text("");
            $("#searchResults").append($searchResults);
        });//返回上一步


        $("#searchForVSM").click(function(){
            $("#first").hide();
            $("#second").show();
            var query = $("#inputForPM").val();
            $("#searchResults").text("");
            $.ajax({
                type:"POST",
                url:"probabilityModel/search",
                dataType:"json",
                data:{"query":query},
                contentType:"application/x-www-form-urlencoded; charset=utf-8",
                traditional: true,
                success:function(result){
                    console.log(result);
                    json=result;
                    $.each(result,function(index,obj) {
                        var str1 = obj.content.substring(0,90)+ "......";
                        $('#searchResults').append("<a id='"+index+"' href='' class='ra' style='font-size: 20px;font-family=Microsoft Yahei;font-weight: bold; margin-right: 20px' data-toggle='modal' data-target='#myModal' onclick='getContent(this.id)' >"+obj.title+"</a>");
                        $('#searchResults').append("<br>");
                        $('#searchResults').append("<p>"+str1+"</p>");

                    });
                    $searchResults=$("#searchResults").find("*");
                },
                error:function(){
                    alert("检索出错！");
                    $("#searchResults").text("");// 清空数据
                }
            })
        });//检索功能

        $("#PPQ").click(function () {
            var query=$("#inputForPM").val();
            $("#results").text("");
            $.ajax({
                type:"POST",
                url:"probabilityModel/PPQ",
                dataType:"json",
                data:{"query":query},
                contentType:"application/x-www-form-urlencoded; charset=utf-8",
                traditional: true,
                success:function(result){
                    console.log(result);
                    $("#results").append(
                        "查询语句内容："+query+"<br>"+
                        "索引项："+result.itemsForSearch+"<br>"
                    )
                },
                error:function(){
                    alert("检索出错！");
                    $("#searchResults").text("");// 清空数据
                }
            })//end of ajax
        })//求索引项功能

        $("#calculateBij").click(function () {
            var query=$("#inputForPM").val();
            $("#results").text("");
            $.ajax({
                type:"POST",
                url:"probabilityModel/bij",
                data:{"query":query},
                dataType:"json",
                contentType:"application/x-www-form-urlencoded; charset=utf-8",
                traditional: true,
                success:function(bijs){
                    console.log(bijs);
                    $("#results").append(
                        "<div class=\"table-responsive\" style=\"text-align:center;font-family:Microsoft Yahei;\">\n" +
                        "    <table class=\"table\">\n" +
                        "        <thead style=\"color:#000000;\">\n" +
                        "            <tr style='border-bottom:3px solid rgb(0,0,0)'>\n" +
                        "                <th>词项</th>\n" +
                        "                <th>文档ID</th>\n" +
                        "                <th>Bij值</th>\n" +
                        "            </tr>\n" +
                        "        </thead>\n" +
                        "        <tbody id='tbody'></tbody>\n" +
                        "    </table>\n" +
                        "</div>");

                    $.each(bijs,function(index,obj) {
                        console.log(obj);
                        $('#tbody').append("<tr>\n"+
                            "<td class=\"smallTableForTd\" >"+obj.term+"</td>\n"+
                            "<td class=\"smallTableForTd\" >"+obj.ID+"</td>\n"+
                            "<td class=\"smallTableForTd\" >"+obj.bij+"</td>\n"+
                            "</tr>\n"
                        );
                    });//end of each
                },
                error:function(){
                    alert("检索出错！");
                    $("#results").text("");// 清空数据
                }
            })//end of ajax
        })//求Bij功能

        $("#similarities").click(function () {
            var query=$("#inputForPM").val();
            $("#results").text("");
            $.ajax({
                type:"POST",
                url:"probabilityModel/similarity",
                data:{"query":query},
                dataType:"json",
                contentType:"application/x-www-form-urlencoded; charset=utf-8",
                traditional: true,
                success:function(similarity){
                    console.log(similarity);
                    $("#results").append(
                        "<div class=\"table-responsive\" style=\"text-align:center;font-family:Microsoft Yahei;\">\n" +
                        "    <table class=\"table\">\n" +
                        "        <thead style=\"color:#000000;\">\n" +
                        "            <tr style='border-bottom:3px solid rgb(0,0,0)'>\n" +
                        "                <th style='width:60px'>文档ID</th>\n" +
                        "                <th>文档名</th>\n" +
                        "                <th>相似度</th>\n" +
                        "            </tr>\n" +
                        "        </thead>\n" +
                        "        <tbody id='tbody'></tbody>\n" +
                        "    </table>\n" +
                        "</div>");

                    $.each(similarity,function(index,obj) {
                        console.log(obj);
                        $('#tbody').append("<tr>\n"+
                            "<td class=\"smallTableForTd\" >"+obj.web_id+"</td>\n"+
                            "<td class=\"smallTableForTd\" >"+obj.title+"</td>\n"+
                            "<td class=\"smallTableForTd\" >"+obj.similarity+"</td>\n"+
                            "</tr>\n"
                        );
                    });//end of each
                },
                error:function(){
                    alert("检索出错！");
                    $("#results").text("");// 清空数据
                }
            })//end of ajax


        })//求相似度

        $("#sortSimilarity").click(function () {
            var query=$("#inputForPM").val();
            $("#results").text("");
            $.ajax({
                type:"POST",
                url:"probabilityModel/sortSimilarity",
                data:{"query":query},
                dataType:"json",
                contentType:"application/x-www-form-urlencoded; charset=utf-8",
                traditional: true,
                success:function(similarity){
                    console.log(similarity);
                    $("#results").append(
                        "<div class=\"table-responsive\" style=\"text-align:center;font-family:Microsoft Yahei;\">\n" +
                        "    <table class=\"table\">\n" +
                        "        <thead style=\"color:#000000;\">\n" +
                        "            <tr style='border-bottom:3px solid rgb(0,0,0)'>\n" +
                        "                <th style='width:60px'>文档ID</th>\n" +
                        "                <th>文档名</th>\n" +
                        "                <th>相似度</th>\n" +
                        "            </tr>\n" +
                        "        </thead>\n" +
                        "        <tbody id='tbody'></tbody>\n" +
                        "    </table>\n" +
                        "</div>");

                    $.each(similarity,function(index,obj) {
                        console.log(obj);
                        $('#tbody').append("<tr>\n"+
                            "<td class=\"smallTableForTd\" >"+obj.web_id+"</td>\n"+
                            "<td class=\"smallTableForTd\" >"+obj.title+"</td>\n"+
                            "<td class=\"smallTableForTd\" >"+obj.similarity+"</td>\n"+
                            "</tr>\n"
                        );
                    });//end of each
                },
                error:function(){
                    alert("检索出错！");
                    $("#results").text("");// 清空数据
                }
            })//end of ajax


        })//按相似度降序排序

        function getContent(id){
            $.each(json,function(index,obj) {
                if (index==id) {
                    $("#searchResults").text("");
                    $("#searchResults").append(obj.content);
                }
            });
        };
    })

    function getContent(id){
        $.each(json,function(index,obj) {
            if (index==id) {
                $("#searchResults").text("");
                $("#searchResults").append(obj.content);
            }
        });
    };

</script>
</html>